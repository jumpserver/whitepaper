如前所述，过去十年间，堡垒机所处的外部环境发生了翻天覆地的变化，这给传统堡垒机带来了非常大的挑战。另外，企业IT软件领域的技术架构也有了长足的进步，技术组件从闭源走向开源，并且涌现出了非常多丰富好用的组件。新的外部环境和新的产品技术共同推动了新一代堡垒机的诞生。新一代的堡垒机的内涵主要体现在简单易用、分布式架构、广泛资产类型、软件部署和开源开放这五个方面。

## 3.1简单易用
	
随着越来越多的企业在经营环节进行数字化改造，企业内必然有越来越多的泛 IT 人员需要使用堡垒机。这给原来为专业 IT 运维人员设计使用的堡垒机带来了用户使用体验的新挑战。新一代堡垒机需要在产品的简单易用性方面明显上一个台阶才能够满足企业在堡垒机应用体验方面的新需求。用户使用体验上的简单易用主要表现在以下几个方面：

■ 低使用门槛。好的产品可以让使用者以最低的学习成本快速地使用起来。堡垒机的用户角色多种多样，但是终端使用者是其最主要的使用群体。而且，由于越来越多 IT 设备和应用需要接入堡垒机，堡垒机的终端使用者也由传统的专业 IT 人员扩展到企业内任何需要和 IT 设备及应用打交道的泛 IT 群体。在这种情况下，我们要考虑的是产品对于众多使用者是否轻便，能否能达到“傻瓜式”操作的目标 。

这就需要新一代堡垒机在保持传统专业访问途径的前提下能够提供新型的访问途径，让没有任何 IT 背景的用户也能够快速上手，不需要安装任何复杂的客户端或者插件即可进行访问。而在“浏览器为王”的时代，通过浏览器访问是最简便的方式，在任何只要有浏览器的终端上就能访问资产，这才是真正的简单易用；

■ 交互方式友好。很多传统堡垒机的交互方式还停留在上个时代的桌面软件时代。在互联网产品交互模式和技术愈发丰富和灵活的当下，新一代堡垒机的交互方式应该遵循主流互联网产品的体验模式。这会让大量的泛 IT 人群更容易接受，并能大幅降低软件培训和学习的成本。

## 3.2分布式架构

如今，软件的分布式架构已经在互联网业务系统中被广泛使用，并取得了巨大的成功。而对于大部分的堡垒机产品来说，分布式还是一个比较新的概念，被采纳的程度并不理想。但就像前面所介绍的那样，堡垒机外部环境的剧烈变化对堡垒机的分布式架构提出了迫切的需求。具体表现在如下几个方面：

■ 堡垒机需要纳管的资产规模在快速增加，最终使用的用户从几十人发展到几百人，乃至上千人。这意味着堡垒机需要承受非常高的并发压力，而且这种并发压力已经达到靠传统垂直伸缩的模式无法支撑的阶段。面对这一问题，传统堡垒机的解决方案经常是部署多套独立运行的堡垒机。这种方案无疑会带来部署成本和维护成本的显著上升。而软件分布式架构则是一种能够更好地面对这一问题的解决方案。为此，基于分布式架构的水平伸缩能力成为新一代堡垒机的必然之选。要建设这种分布式架构，堡垒机产品架构的每一层逻辑都需要能够独立解耦，从前端到业务层，再到后端数据库。这样一来，在将来资产快速扩张和并发压力快速增加的时候，就能够做到在线水平扩容，并且不会对正常业务造成负面影响；

■ 堡垒机需要纳管的资产分布与访问分散化。由于企业内部有越来越多的运营环节依赖于 IT 系统的支撑，随着线上数字业务的发展，企业 IT 系统覆盖的区域也在快速扩张。为此，原来人员集中、资产集中的堡垒机使用场景快速分散化。新一代堡垒机需要能够解决来自各地不同人员对分散在各地的不同资产进行快速访问的需求。而且这种访问最好能够遵循“网络就近原则”，以提供给用户更好的使用体验。与之相比，传统堡垒机的解决方案还是以分地域多套部署为主。传统方案一方面增加了部署和管理的成本，另外一方面也达不到分散资源统一管理的目标。通过分布式架构，新一代堡垒机可以做到组件分布式部署，并通过网络路由达到最优访问路径的选择，从而实现分散资产集中管理和分散人员就近访问的平衡；

■ 堡垒机的分布式架构还可以让系统的每个组件都具备独立高可用部署的能力。分布式架构下，当整体架构中任一组件的任一节点出现问题时，对整体业务可以做到不中断、无感知，保证可用性且具备快速容灾切换的能力，保障运维安全系统的稳定高效运行。另外，分布式架构还可以让堡垒机根据不同使用场景下的实际需求对不同组件进行独立的容量规划和安排，尽可能做到资源的高效利用；

■ 支持大规模分布式环境下的多租户管理。对于现在集团型企业或者多数据中心的企业而言，堡垒机的部署和管理模式是一个很大的难题。传统的解决方案是每个子公司或者每个数据中心都部署一套独立的堡垒机，但这样带来的问题是部署成本的快速攀升，并且还需要不断地扩充硬件，并且每套堡垒机都得独立管理，管理成本快速增加，需要重复进行管理。如果能够把云计算中的关键特性——“多租户”融入到堡垒机的设计理念中，让一套堡垒机能够统一管理不同数据中心乃至不同租户（子公司或者业务部门）的资产，这无疑会实现关键性的改进。同时，多租户模式还给管理权限下放带来了可能性。用户可以在一套堡垒机内管理全部资产，又可以给每个租户独立的运维管理权限。这样不仅帮助用户削减了管理的复杂性，还能够降低用户的购买成本。

## 3.3广泛的资产类型
	
运维安全审计从早期的字符集、图形、文件传输层审计逐步发展到后期出现的基于 SQL 级别的审计，由此诞生了多种形态的产品。随着企业 IT 系统部署方式和技术栈的变化，未来肯定还会出现新的运维安全审计需求。作为新一代堡垒机，需要考虑尽可能地在一套系统内满足多种运维安全审计需求。截至当前，我们常见的资产类型分为几种：

■ 常规主机及网络设备。这种是我们最常见的设备，支持包括 SSH、RDP、Telnet、VNC 等内的常见协议类型。这些设备从堡垒机诞生之日起就是被作为审计对象的，堡垒机通过相应的协议即可管理对应的设备；

■ 数据库平台。目前市面上涌现出来的新型数据库平台种类很多，不管是传统关系型数据库还是非关系型数据库，或者是云数据库，新一代堡垒机可以考虑将 SQL 级别的数据库运维安全审计回归到堡垒机产品中；

■ 公有云及容器云平台。当客户侧业务量较高和较低时， 云资产的“弹性”空间较大， 这导致了管理人员需要频繁对云上资产进行扩容、缩容。面对这种云资产数量的不确定性，在纳入到堡垒机进行管理时，是否能够对其进行灵活管理就变得十分重要，否则刚刚纳入堡垒机的资产，可能在一天后就被删除。这对于堡垒机的运维人员来说是一件极其痛苦的事情，而且频繁的操作也意味着更高的出错率。

因此，新一代堡垒机需要做到云资产的频繁变更和简化堡垒机管理之间的平衡。基础设施云化后，要求堡垒机能够在资产管理上有较好的适配性和灵活性，最好能够适配云平台的 API 接口，有效降低平台资源管理的难度。另外，随着 Kubernetes 成为构建容器云平台的事实标准，很多企业在开发测试及生产环境中都部署了多套 Kubernetes 集群，使用人员也越来越广泛，这也带来了系统安全合规的不确定性。新一代堡垒机需要将 Kubernetes 集群运维的安全审计也纳入到能力范围之内；

■ 浏览器等其他类型应用。在“浏览器为王”的数字化时代，软件系统是非常重要的资产之一。用户在软件系统中所做的重要操作需要被留痕审计，因此泛 IT 人群引入的各种软件自然也需要作为审计对象被新一代堡垒机所纳管进来。

## 3.4 软件部署
	
传统堡垒机多以硬件形式进行售卖，硬件一体机本质上就是将软件部署在独立的硬件设备之上。尽管硬件一体机在部署上线和独立运维上有一定的优势，但在面临新一代堡垒机需要解决的各种需求时，硬件形态越来越成为一种限制和束缚。同时，硬件一体机带来的额外硬件维护管理工作也成为了运维人员的一种负担。随着硬件虚拟化技术及云平台的普及，软件部署的方式逐渐成为堡垒机的首选部署方式。相较于硬件而言，软件模式不仅更易于部署和维护，还在扩缩容、高可用方案上更具灵活性。

■ 易于部署和维护。软件形式的堡垒机只需要一台虚拟机或者云主机即可进行部署，省去了前期的布线、上架等操作，也不需要进行后期繁重的硬件运维工作。尤其是在公有云环境下，软件部署已经成为其唯一的选择；

■ 易于扩容和缩容。软件形式部署的堡垒机，在后期需要扩容时，不需要考虑硬件的交付周期，可以随时部署一台虚拟机或者云主机，即可实现分钟级的扩容。在需要对堡垒机容量进行扩缩容时，软件部署方式可以灵活支持水平和垂直的扩容模式，以实现分钟级扩缩容。对于业务弹性较大的互联网类应用体系来说，软件部署的方式在最大程度上降低了用户的总体拥有成本，减轻了运维人员的工作量。

## 3.5 开源开放

当前 IT 行业有两个重要的趋势：一是软件吞噬一切。传统的计算、网络、存储各个方面都在向软件演变，软件正在定义一切；另一个趋势是开源。越来越多的公司正在拥抱开源。

开源被越来越多的用户所接受。据统计，80% 的企业用户正在使用开源组件或者开源系统。开源模式使得越来越多的用户和贡献者参与进来。参与的用户越多，给产品提建议的人也越多，产品的功能就越丰富，迭代速度也更快，产品就愈加稳定和安全。产品更稳定、更安全、功能更丰富，又带来了更大的用户规模。如此反复，开源的飞轮自动高速运转，这就是开源的魔力。
 
图4 开源软件的飞轮效应

![开源软件的飞轮效应](../public/whitepaper/image004.jpg "开源软件的飞轮效应")

除开源外，软件领域的另外一个显著趋势就是软件的开放化。随着企业采纳的软件越来越多，企业越需要形成不同软件之间的协同操作和数据交换。因此，软件的开放接口支持能力正在成为现代软件重要的考核指标，业界为此也先后发展出各种软件接口交互协议（例如 Web Service、RESTful API 等）。

作为基础安全产品之一，传统堡垒机基本以封闭式软件或者硬件一体机的方式进行运营和交付。这种模式具有其独特性和时代背景，但这一模式也明显限制了堡垒机产品技术的迭代以及广泛的市场采纳。作为新一代堡垒机产品，选择开源模式运营并特别重视产品的对外开放性是其最为显著的特征。具体表现在以下几个方面：

■ 开源模式让堡垒机产品可以更加广泛地被企业所采纳。尽管等保规范和企业安全管理需求的快速提升推动了堡垒机的企业采纳率，但传统封闭模式下的运营方式还是极大地限制了大量新型企业采纳堡垒机产品。尤其是中国高速发展的数字经济催生了大量的互联网企业，他们的业务发展快，自我研发能力强，并且广泛使用各种开源软件。开源模式运营的堡垒机让他们可以以极低的成本和极快的速度基于堡垒机构建自己的运维安全审计平台，帮助企业在发展早期就形成较好的运维安全管理体系；

■ 开源模式赋予安全软件快速进行产品迭代的动能。基于开源模式运营，堡垒机产品会被用户广泛采纳，产品功能需求和缺陷发现的迭代动能从来自一个单独的原厂变成了整个庞大的用户社区。开源软件的研发协作方式经过多年的发展已经变得十分成熟，国内庞大的工程师群体可以充分利用这个机制共同推进软件产品的进步和成熟；

■ 开源模式推动了产品的开放性发展。由于开放源代码的公开性和接口 API 的标准化，用户会基于开源软件进行广泛的二次开发和周边系统对接。这也就让堡垒机从一个独立的开源产品发展成为能够无缝融合到企业安全建设体系内的开放产品。
